# 安装指南

## 系统要求

### 必需环境

| 组件 | 版本要求 | 说明 |
|------|----------|------|
| Node.js | ≥18.0.0 | JavaScript运行时 |
| npm | ≥9.0.0 | 包管理器 |
| Git | ≥2.30 | 版本控制 |
| Claude Code | ≥1.0.0 | AI编码助手 |

### 可选环境（Java开发）

| 组件 | 版本要求 | 说明 |
|------|----------|------|
| JDK | 17 或 21 | Java开发工具包 |
| Maven | ≥3.8 | 构建工具（二选一） |
| Gradle | ≥8.0 | 构建工具（二选一） |

## 安装方式

### 方式1：NPM全局安装（推荐）

最简单的安装方式，适合快速上手。

```bash
# 1. 全局安装
npm install -g lcyf-claude-code

# 2. 验证安装
lcyf --version
# 输出: lcyf-claude-code v2.0.0

# 3. 初始化项目
cd /path/to/your/java/project
lcyf init

# 4. 开始使用
# 在 Claude Code 中输入命令
# /lcyf-新功能
```

### 方式2：Claude Code Plugin 安装

通过 Claude Code 插件系统安装。

```bash
# 1. 在 Claude Code 中执行
/plugin marketplace add lcyf-claude-code

# 2. 安装插件
/plugin install lcyf-claude-code

# 3. 验证安装
/plugin list
# 应显示 lcyf-claude-code v2.0.0

# 4. 初始化项目配置
/lcyf-init
```

### 方式3：手动安装

适合需要自定义或开发贡献的用户。

```bash
# 1. 克隆仓库
git clone https://github.com/a623556943/lcyf-claude-code.git
cd lcyf-claude-code

# 2. 安装依赖
npm install

# 3. 链接到全局（可选）
npm link

# 4. 复制组件到 Claude Code 配置目录

# Windows
xcopy /E /I agents %USERPROFILE%\.claude\agents
xcopy /E /I commands %USERPROFILE%\.claude\commands
xcopy /E /I skills %USERPROFILE%\.claude\skills
xcopy /E /I rules %USERPROFILE%\.claude\rules

# macOS/Linux
cp -r agents ~/.claude/agents/
cp -r commands ~/.claude/commands/
cp -r skills ~/.claude/skills/
cp -r rules ~/.claude/rules/

# 5. 配置 hooks
# 将 hooks/hooks.json 内容合并到 ~/.claude/settings.json
```

### 方式4：Docker 安装（开发环境）

```bash
# 1. 拉取镜像
docker pull lcyf/claude-code:2.0

# 2. 运行容器
docker run -it \
  -v /path/to/project:/workspace \
  -v ~/.claude:/root/.claude \
  lcyf/claude-code:2.0

# 3. 容器内使用
lcyf init /workspace
```

## 初始化配置

### 交互式初始化

```bash
lcyf init

# 交互流程
? 项目名称: my-project
? 基础包名: com.example.myproject
? 作者姓名: 张三
? 作者邮箱: zhangsan@example.com
? 选择功能:
  ◉ 持续学习
  ◉ 自动验证
  ◉ 代码审查
  ◯ 性能监控
? 确认创建配置? Yes

✓ 配置已创建: .lcyf/config.json
✓ 知识库已初始化: .lcyf/
✓ Git忽略规则已更新: .gitignore

初始化完成！
运行 'lcyf status' 查看状态
```

### 命令行参数初始化

```bash
lcyf init \
  --name my-project \
  --package com.example.myproject \
  --author "张三" \
  --email "zhangsan@example.com" \
  --features "continuous-learning,auto-verification"
```

### 配置文件初始化

创建 `.lcyf/config.json`:

```json
{
  "project": {
    "name": "my-project",
    "basePackage": "com.example.myproject",
    "javaVersion": "17",
    "buildTool": "maven"
  },
  "author": {
    "name": "张三",
    "email": "zhangsan@example.com"
  },
  "features": {
    "continuousLearning": true,
    "autoVerification": true,
    "codeReview": true,
    "performanceMonitor": false
  },
  "modules": [
    "system",
    "sales",
    "finance"
  ]
}
```

然后运行:
```bash
lcyf init --config .lcyf/config.json
```

## 团队配置

### 统一团队配置

```bash
# 团队负责人执行
lcyf team setup

# 导出配置
lcyf team export team-config.json

# 分享给团队成员
# team-config.json 包含:
# - 代码规范
# - 测试要求
# - Git工作流
# - 命名规范
```

### 团队成员导入

```bash
# 团队成员执行
lcyf team import team-config.json
```

### 团队配置文件示例

```json
{
  "team": {
    "name": "lcyf开发团队",
    "size": "medium"
  },
  "standards": {
    "codeReview": "mandatory",
    "testCoverage": 80,
    "gitWorkflow": "git-flow"
  },
  "conventions": {
    "naming": {
      "controller": "{Entity}Controller",
      "service": "I{Entity}Service",
      "serviceImpl": "{Entity}ServiceImpl",
      "mapper": "{Entity}Mapper"
    },
    "package": {
      "controller": "adapter.web",
      "service": "biz.service",
      "mapper": "biz.infrastructure.mapper",
      "entity": "biz.infrastructure.entity"
    }
  }
}
```

## 验证安装

### 检查组件

```bash
lcyf validate

# 输出示例
正在验证配置...

✓ 项目结构正确
✓ package.json 有效
✓ Agents配置正确 (8/8)
✓ Commands配置正确 (20/20)
✓ Skills配置正确 (15/15)
✓ Rules配置正确 (11/11)
✓ Hooks配置正确 (25/25)
✓ Templates配置正确 (18/18)

所有配置验证通过！
```

### 测试功能

```bash
# 在 Claude Code 中测试
/lcyf-验证 quick

# 或使用CLI测试
lcyf test
```

## 卸载

### 方式1：NPM卸载

```bash
npm uninstall -g lcyf-claude-code
```

### 方式2：Plugin卸载

```bash
/plugin uninstall lcyf-claude-code
```

### 方式3：手动卸载

```bash
# 删除配置目录中的组件
rm -rf ~/.claude/agents/0*-*.md
rm -rf ~/.claude/commands/lcyf-*.md
rm -rf ~/.claude/skills/workflows
rm -rf ~/.claude/skills/java-full-stack
rm -rf ~/.claude/rules/0*-*.md
rm -rf ~/.claude/rules/1*-*.md

# 删除项目知识库（可选）
rm -rf .lcyf/
```

## 常见问题

### Q1: npm install 失败

```bash
# 清理缓存重试
npm cache clean --force
npm install -g lcyf-claude-code
```

### Q2: 权限不足

```bash
# macOS/Linux
sudo npm install -g lcyf-claude-code

# 或使用nvm避免权限问题
nvm install 18
nvm use 18
npm install -g lcyf-claude-code
```

### Q3: Claude Code 找不到命令

确保已正确配置 `~/.claude/settings.json`:
```json
{
  "enabledPlugins": {
    "lcyf-claude-code": true
  }
}
```

### Q4: hooks 不生效

检查 `~/.claude/settings.json` 中的 hooks 配置是否正确加载。

### Q5: 模板变量未替换

确保使用正确的 Mustache 语法: `{{variableName}}`

## 升级

### 升级到最新版本

```bash
# NPM
npm update -g lcyf-claude-code

# Plugin
/plugin update lcyf-claude-code
```

### 升级到指定版本

```bash
npm install -g lcyf-claude-code@2.1.0
```

### 检查更新

```bash
lcyf update check
```

## 获取帮助

- **文档**: `lcyf docs` 打开文档
- **状态**: `lcyf status` 查看系统状态
- **验证**: `lcyf validate` 验证配置
- **Issues**: https://github.com/a623556943/lcyf-claude-code/issues
