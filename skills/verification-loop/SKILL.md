# 验证循环技能

## 概述

提供自动化的代码质量验证能力，确保代码符合质量标准。

## 验证类型

### 1. 构建验证

检查代码是否能正常编译。

```bash
# Maven构建
mvn clean compile -q

# Gradle构建
gradle compileJava --quiet
```

**检查项**:
- 编译错误
- 依赖问题
- 资源文件

### 2. 测试验证

运行测试确保功能正确。

```bash
# 运行所有测试
mvn test

# 运行指定测试
mvn test -Dtest=UserServiceTest
```

**检查项**:
- 单元测试通过
- 集成测试通过
- 测试覆盖率≥80%

### 3. 代码规范验证

检查代码是否符合规范。

```bash
# Checkstyle检查
mvn checkstyle:check

# PMD检查
mvn pmd:check
```

**检查项**:
- 命名规范
- 代码格式
- 复杂度限制
- 注释规范

### 4. 安全验证

检查代码安全性。

**检查项**:
- 硬编码密钥
- SQL注入风险
- XSS风险
- 依赖漏洞

## 验证模式

### quick - 快速验证

适用于开发过程中的快速检查。

```
执行内容:
- 编译检查
- 变更文件的单元测试
耗时: ~30秒
```

### full - 完整验证

适用于提交前的全面检查。

```
执行内容:
- 编译检查
- 所有测试
- 代码规范检查
- 安全扫描
- 覆盖率检查
耗时: ~5分钟
```

### pre-commit - 提交前验证

适用于Git提交前的检查。

```
执行内容:
- 编译检查
- 变更文件的测试
- 变更文件的规范检查
- 敏感信息检查
耗时: ~1分钟
```

### pre-pr - PR前验证

适用于创建PR前的检查。

```
执行内容:
- 完整验证
- 模块依赖检查
- API兼容性检查
耗时: ~10分钟
```

## 验证流程

```
┌─────────────────┐
│   触发验证      │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   构建检查      │ ← 编译、依赖
└────────┬────────┘
         │ 通过
         ▼
┌─────────────────┐
│   测试检查      │ ← 单元测试、集成测试
└────────┬────────┘
         │ 通过
         ▼
┌─────────────────┐
│   规范检查      │ ← Checkstyle、PMD
└────────┬────────┘
         │ 通过
         ▼
┌─────────────────┐
│   安全检查      │ ← 漏洞、敏感信息
└────────┬────────┘
         │ 通过
         ▼
┌─────────────────┐
│   覆盖率检查    │ ← JaCoCo
└────────┬────────┘
         │ 通过
         ▼
┌─────────────────┐
│   验证通过 ✅   │
└─────────────────┘
```

## 验证报告

```markdown
# 验证报告

## 基本信息
- 验证模式: full
- 验证时间: 2025-01-26 10:00:00
- 总耗时: 5分32秒

## 验证结果

| 检查项 | 状态 | 详情 |
|--------|------|------|
| 构建 | ✅ 通过 | 编译成功 |
| 测试 | ✅ 通过 | 156/156通过 |
| 覆盖率 | ✅ 通过 | 85% (≥80%) |
| 规范 | ⚠️ 警告 | 3个警告 |
| 安全 | ✅ 通过 | 无高风险 |

## 详细信息

### 测试覆盖率
- 行覆盖率: 85%
- 分支覆盖率: 78%
- 方法覆盖率: 92%

### 规范警告
1. UserService.java:45 - 方法过长(52行)
2. OrderController.java:30 - 缺少Javadoc
3. ConfigService.java:18 - 魔法数字

## 总结
✅ 验证通过，可以提交
```

## 质量门禁

### 强制通过项

- [ ] 编译成功
- [ ] 所有测试通过
- [ ] 无安全高风险

### 警告项（建议修复）

- [ ] 测试覆盖率<80%
- [ ] 代码规范警告
- [ ] 安全中风险

## 使用方式

```bash
# 快速验证
/lcyf-验证 quick

# 完整验证
/lcyf-验证 full

# 提交前验证
/lcyf-验证 pre-commit

# PR前验证
/lcyf-验证 pre-pr
```

## 关联Agent

- 05-代码审查专家
- 06-安全审查专家
- 07-测试专家

## 关联命令

- `/lcyf-验证` - 执行验证
- `/lcyf-代码审查` - 代码审查
- `/lcyf-安全扫描` - 安全扫描
