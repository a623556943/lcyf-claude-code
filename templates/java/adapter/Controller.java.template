package com.lcyf.cloud.module.{{moduleName}}.adapter.web.{{domainName}};

import com.lcyf.cloud.framework.common.pojo.CommonResult;
import com.lcyf.cloud.framework.common.pojo.PageResult;
import com.lcyf.cloud.framework.common.util.MapUtils;
import com.lcyf.cloud.module.{{moduleName}}.biz.service.I{{EntityName}}Service;
import com.lcyf.cloud.module.{{moduleName}}.api.pojo.dto.{{EntityName}}Dto;
import com.lcyf.cloud.module.{{moduleName}}.api.pojo.cmd.{{EntityName}}AddCmd;
import com.lcyf.cloud.module.{{moduleName}}.api.pojo.cmd.{{EntityName}}UpdateCmd;
import io.swagger.v3.oas.annotations.Operation;
import io.swagger.v3.oas.annotations.tags.Tag;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.validation.Valid;
import lombok.RequiredArgsConstructor;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.*;

/**
 * {{description}} Web控制器
 *
 * 业务职责:
 * 1. 处理{{description}}相关的HTTP请求
 * 2. 参数验证和转换
 * 3. 调用Service层业务逻辑
 * 4. 返回统一格式的响应
 *
 * @author {{author}}
 * @since {{date}}
 */
@RestController
@RequestMapping("/api/v1/{{moduleName}}/auth/{{urlPath}}")
@Tag(name = "{{description}}")
@RequiredArgsConstructor
@Validated
public class {{EntityName}}Controller {

    private final I{{EntityName}}Service {{entityName}}Service;

    /**
     * 分页查询{{description}}
     *
     * 业务场景: 条件查询{{description}}列表，支持分页和排序
     *
     * @param request HTTP请求，用于提取查询参数
     * @return 分页结果集
     */
    @GetMapping("/page")
    @Operation(summary = "分页查询{{description}}")
    public CommonResult<PageResult<{{EntityName}}Dto>> page(HttpServletRequest request) {
        return CommonResult.success({{entityName}}Service.get{{EntityName}}Page(MapUtils.flat(request.getParameterMap())));
    }

    /**
     * 查询{{description}}详情
     *
     * 业务场景: 根据ID查询{{description}}完整信息
     *
     * @param id {{description}}ID
     * @return {{description}}详情数据
     */
    @GetMapping("/{id}")
    @Operation(summary = "获取{{description}}详情")
    public CommonResult<{{EntityName}}Dto> get(@PathVariable Long id) {
        return CommonResult.success({{entityName}}Service.get(id));
    }

    /**
     * 新增{{description}}
     *
     * 业务场景: 新增{{description}}记录
     *
     * @param cmd 新增命令对象，包含必需的业务字段
     * @return 操作结果
     */
    @PostMapping("/add")
    @Operation(summary = "新增{{description}}")
    public CommonResult<Object> add(@RequestBody @Valid {{EntityName}}AddCmd cmd) {
        {{entityName}}Service.create(cmd);
        return CommonResult.success();
    }

    /**
     * 修改{{description}}
     *
     * 业务场景: 修改{{description}}记录
     *
     * @param cmd 更新命令对象
     * @return 操作结果
     */
    @PutMapping("/update")
    @Operation(summary = "修改{{description}}")
    public CommonResult<Object> update(@RequestBody @Valid {{EntityName}}UpdateCmd cmd) {
        {{entityName}}Service.modify(cmd);
        return CommonResult.success();
    }

    /**
     * 删除{{description}}
     *
     * 业务场景: 逻辑删除{{description}}记录
     *
     * @param id {{description}}ID
     * @return 操作结果
     */
    @DeleteMapping("/delete/{id}")
    @Operation(summary = "删除{{description}}")
    public CommonResult<Object> delete(@PathVariable Long id) {
        {{entityName}}Service.delete(id);
        return CommonResult.success();
    }
}
